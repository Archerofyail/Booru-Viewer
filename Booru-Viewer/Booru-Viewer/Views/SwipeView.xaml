<Page
	x:Class="Booru_Viewer.Views.SwipeView"
	xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
	xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
	xmlns:local="using:Booru_Viewer.Views"
	xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
	xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
	mc:Ignorable="d"
	xmlns:vm="using:Booru_Viewer.ViewModels"
	xmlns:controls="using:Microsoft.Toolkit.Uwp.UI.Controls">
	<Page.DataContext>
		<vm:SwipViewViewModel/>
	</Page.DataContext>
	<Page.Resources>
		<SolidColorBrush Color="{ThemeResource SystemAccentColor}"
						 x:Key="AccentColorBrush"></SolidColorBrush>
		<DataTemplate x:Name="Tag">
			<StackPanel Orientation="Horizontal"
							Background="{ThemeResource AccentColorBrush}"
							BorderThickness="1" Margin="0,0,0,-5"
							>

				<StackPanel.BorderBrush>
					<SolidColorBrush Color="{ThemeResource SystemBaseLowColor}"/>
				</StackPanel.BorderBrush>
				<TextBlock Name="Tag"
							     Text="{Binding Path=Tag, Mode=TwoWay}" 
							   MinWidth="20" 
							   Margin="10" 
							   HorizontalAlignment="Center" 
							   VerticalAlignment="Center"
							   Foreground="White"/>
				<Button
					Command="{Binding CopyTag}"
					CommandParameter="{Binding ElementName=Tag, Path=Text}"
					Background="#FF7C7C7C" VerticalAlignment="Stretch">
					<Button.Content>
						<SymbolIcon Symbol="Copy"/>
					</Button.Content>
				</Button>

			</StackPanel>
		</DataTemplate>
	</Page.Resources>
	<Grid Background="{ThemeResource ApplicationPageBackgroundThemeBrush}">
		<FlipView
			ItemsSource="{Binding Images}"
			SelectedIndex="{Binding Index, Mode=TwoWay}"
			Name="FlipView">
			<FlipView.ItemTemplate>
				<DataTemplate>
					<ScrollViewer ZoomMode="Enabled"
								MinZoomFactor="1"
								MaxZoomFactor="15"
								AllowFocusOnInteraction="True"
								HorizontalScrollMode="Enabled"
								VerticalScrollMode="Enabled"
								  >
					<controls:ImageEx
						Source="{Binding FullImage}"
						HorizontalAlignment="Stretch"
						VerticalAlignment="Stretch">

					</controls:ImageEx>
					</ScrollViewer>
				</DataTemplate>
			</FlipView.ItemTemplate>

		</FlipView>
	</Grid>
	<Page.BottomAppBar>
		<CommandBar>
			<AppBarButton Label="Save Image"
						  Icon="Save"
						  Command="{Binding SaveImage}">
				<ToolTip
						 IsOpen="{Binding Saving}">
					<TextBlock Text="{Binding SaveImageFailureReason}"></TextBlock>
				</ToolTip>
			</AppBarButton>
			<AppBarButton Label="View Tags"
						  Icon="List">
				<AppBarButton.Flyout>
					<Flyout>
						<ListView ItemsSource="{Binding Tags}"
								  ItemTemplate="{StaticResource Tag}"/>
					</Flyout>
				</AppBarButton.Flyout>
			</AppBarButton>
		</CommandBar>
	</Page.BottomAppBar>
</Page>

